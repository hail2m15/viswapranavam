<?phpnamespace Controllers;use Core\View,    Helpers\Session,    Helpers\Url;class Auth extends \Core\Controller {    private $_model;    public function __construct() {        parent::__construct();        $this->_model = new \Models\AuthModel();    }    public function login() {        View::renderTemplate('header', array('title' => 'Login'));        if (Session::get('vadmin')) {            Url::redirect('admin/home');        } else if (Session::get('vhealer')) {            Url::redirect('healer/home');        }else if (Session::get('vuser')) {            Url::redirect('user/home');        }        if (isset($_POST['submit'])) {            $name = $_POST['username'];            $password = $_POST['password'];            //for hashing            /*  $options = [              'cost' => 11              ];//$2y$11$XOQsDykO33X4ZD3FpLNiBezCK7J7W/VPps/OTI3aO.g6lLvrFdHTS              $hash = password_hash($password, PASSWORD_BCRYPT, $options);              echo $hash;             */            $value = $this->_model->getPassword($name);            //validation            if (password_verify($password, $value->password)) {                if ($value->level == '0') {                    Session::set('vadmin', true);                    Session::set('id', $value->fid);                    Url::redirect('admin/home');                } else if ($value->level == '1') {                    Session::set('vhealer', true);                    Session::set('id', $value->fid);                    Url::redirect('healer/home');                }else if ($value->level == '2') {                    Session::set('vuser', true);                    Session::set('id', $value->fid);                    Url::redirect('user/home');                }            } else {                $error = 'Wrong username or password!';            }        }        View::render('userLogin', $data, $error);        View::renderTemplate('footer');    }    public function register() {        View::renderTemplate('header', array('title' => 'Register'));        if (isset($_POST['register'])) {            $input = array(                'name' => $_POST['name'],                'email' => $_POST['email'],                'address' => $_POST['address'],                'city' => $_POST['city'],                'state' => $_POST['state'],                'country' => $_POST['country'],                'ccode' => $_POST['ccode'],                'phone' => $_POST['phone'],                'status' => 'Registered',            );            $id = $this->_model->register($input);            $options = [                'cost' => 11            ];            $hash = password_hash($_POST['password'], PASSWORD_BCRYPT, $options);            if ($id) {                $auth = array(                    'username' => $_POST['email'],                    'password' => $hash,                    'fid' => $id,                    'level' => 2                );                 $this->_model->insertLogin($auth);            }                       Url::redirect();        }        View::render('userRegistration');        View::renderTemplate('footer');    }    public function logout() {        Session::destroy();        Url::redirect();    }}