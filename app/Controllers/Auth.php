<?phpnamespace Controllers;use Core\View,    Helpers\Session,    Helpers\Url;class Auth extends \Core\Controller {    private $_model;    public function __construct() {        parent::__construct();        $this->_model = new \Models\AuthModel();    }    public function login() {        View::renderTemplate('header', array('title' => 'Login'));        if (Session::get('vadmin')) {            Url::redirect('admin/home');        } else if (Session::get('vaccountant')) {            Url::redirect('accountant/home');        } else if(Session::get('vhealer')){                        Url::redirect('healer/home');        }        echo 'qqqqqqqqqqqqqqqqqqqqqqqqqqqqw';        if (isset($_POST['submit'])) {            $name = $_POST['username'];            $password = $_POST['password'];            //for hashing            /*  $options = [              'cost' => 11              ];//$2y$11$XOQsDykO33X4ZD3FpLNiBezCK7J7W/VPps/OTI3aO.g6lLvrFdHTS              $hash = password_hash($password, PASSWORD_BCRYPT, $options);              echo $hash;             */            $value = $this->_model->getPassword($name);            //validation            if (password_verify($password, $value->password)) {                if ($value->level == '0') {                    Session::set('vadmin', true);                    Session::set('id', $value->fid);                    Url::redirect('admin/home');                } else if ($value->level == '1') {                    Session::set('vaccountant', true);                    Session::set('id', $value->fid);                    Url::redirect('accountant/home');                } else if ($value->level == '2') {                    Session::set('vhealer', true);                    Session::set('id', $value->fid);                    Url::redirect('healer/home');                }            } else {                $error[] = 'Wrong username or password!';            }        }else {            $error[] = 'Some thing went wrong';        }        View::render('common/login', $data, $error);        View::renderTemplate('footer');    }    public function register() {        View::renderTemplate('header', array('title' => 'Register'));        if (isset($_POST['submit'])) {            $input = array(                'name' => $_POST['name'],                'phone1' => $_POST['phone1'],                'email' => $_POST['email']            );            $id = $this->_model->register($input);            $options = [                'cost' => 11            ];            $hash = password_hash($_POST['password'], PASSWORD_BCRYPT, $options);            $auth = array(                'username' => $_POST['username'],                'password' => $hash,                'fid' => $id,                'type' => 0            );            $this->_model->insertLogin($auth);            Url::redirect();        }        View::render('n_registration');        View::renderTemplate('footer');    }    public function changePassword() {        $this->loadHeader('Change Password');        if (isset($_POST['submit'])) {            $name = $_POST['name'];            if (password_verify($_POST['old'], $this->_model->getPassword1($name))) {                if ($_POST['new'] == $_POST['cnew']) {                    $options = [                        'cost' => 11                    ];                    $hash = password_hash($_POST['new'], PASSWORD_BCRYPT, $options);                    $this->_model->addNewPassword($name, $hash);                    $data = "Password updated successfully!";                } else {                    $error[] = "New password missmatched with confirmation!!";                }            } else {                $error[] = "Wrong password!!";            }        }        View::render('changepassword', $data, $error);        $this->loadFooter();    }    public function logout() {        Session::destroy();        Url::redirect();    }}